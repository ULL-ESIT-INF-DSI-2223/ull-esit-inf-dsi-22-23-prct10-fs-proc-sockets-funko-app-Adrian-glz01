<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>pr10</title><meta name="description" content="Documentation for pr10"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os"</script><header class="tsd-page-toolbar">
<div class="tsd-toolbar-contents container">
<div class="table-cell" id="tsd-search" data-base=".">
<div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M15.7824 13.833L12.6666 10.7177C12.5259 10.5771 12.3353 10.499 12.1353 10.499H11.6259C12.4884 9.39596 13.001 8.00859 13.001 6.49937C13.001 2.90909 10.0914 0 6.50048 0C2.90959 0 0 2.90909 0 6.49937C0 10.0896 2.90959 12.9987 6.50048 12.9987C8.00996 12.9987 9.39756 12.4863 10.5008 11.6239V12.1332C10.5008 12.3332 10.5789 12.5238 10.7195 12.6644L13.8354 15.7797C14.1292 16.0734 14.6042 16.0734 14.8948 15.7797L15.7793 14.8954C16.0731 14.6017 16.0731 14.1267 15.7824 13.833ZM6.50048 10.499C4.29094 10.499 2.50018 8.71165 2.50018 6.49937C2.50018 4.29021 4.28781 2.49976 6.50048 2.49976C8.71001 2.49976 10.5008 4.28708 10.5008 6.49937C10.5008 8.70852 8.71314 10.499 6.50048 10.499Z" fill="var(--color-text)"></path></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div>
<div class="field">
<div id="tsd-toolbar-links"></div></div>
<ul class="results">
<li class="state loading">Preparing search index...</li>
<li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">pr10</a></div>
<div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><rect x="1" y="3" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="7" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="11" width="14" height="2" fill="var(--color-text)"></rect></svg></a></div></div></header>
<div class="container container-main">
<div class="col-8 col-content">
<div class="tsd-page-title">
<h2>pr10</h2></div>
<div class="tsd-panel tsd-typography"><p><a href="https://classroom.github.com/a/NApXvVde"><img src="https://classroom.github.com/assets/deadline-readme-button-24ddc0f5d75046c5622901739e7c5dd533143b0c8e959d652212380cedb1ea36.svg" alt="Review Assignment Due Date"></a></p>

<a href="#informe" id="informe" style="color: inherit; text-decoration: none;">
  <h1>Informe</h1>
</a>
<p>En esta decima práctica se pondrán en práctica los conceptos aprendidos en la clase de teoría sobre Sockets, creación de procesos y sobre los conceptos <em>&#39;pila de llamada&#39;</em> , &#39;<em>cola de manejadores&#39;</em> y <em>&#39;bucle de eventos&#39;</em></p>
<p>Asimismo, se seguirán ampliando los conocimientos sobre el lenguaje de programación javascript y del framework Node.js.</p>

<a href="#índice" id="índice" style="color: inherit; text-decoration: none;">
  <h2>Índice</h2>
</a>
<ol>
<li>Ejercicios <ul>
<li>1.1. <a href="#ejercicio-1">Ejercicio 1.</a></li>
<li>1.2. <a href="#ejercicio-2">Ejercicio 2. - Read file content</a></li>
<li>1.3. <a href="#ejercicio-3">Ejercicio 3. - FunkoPop app</a></li>
</ul>
</li>
<li><a href="#__dificultadesreflexi%C3%B3n">Dificultades/Reflexión.</a></li>
<li><a href="#referencias">Referencias</a></li>
</ol>

<a href="#problemas-práctica-10" id="problemas-práctica-10" style="color: inherit; text-decoration: none;">
  <h2>Problemas práctica 10.</h2>
</a>

<a href="#ejercicio-1" id="ejercicio-1" style="color: inherit; text-decoration: none;">
  <h3><strong>Ejercicio 1:</strong></h3>
</a>
<p>Se ha solicitado entender, ejecutar y trazar el siguiente fragmento de código:</p>
<pre><code class="language-ts"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">*</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-3">fs</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-4">&#39;fs&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">process</span><span class="hl-1">.</span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">length</span><span class="hl-1"> !== </span><span class="hl-5">3</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-4">&#39;Please, specify a file&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">} </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">filename</span><span class="hl-1"> = </span><span class="hl-3">process</span><span class="hl-1">.</span><span class="hl-3">argv</span><span class="hl-1">[</span><span class="hl-5">2</span><span class="hl-1">];</span><br/><br/><span class="hl-1">  </span><span class="hl-3">fs</span><span class="hl-1">.</span><span class="hl-6">access</span><span class="hl-1">(</span><span class="hl-3">filename</span><span class="hl-1">, </span><span class="hl-3">fs</span><span class="hl-1">.</span><span class="hl-3">constants</span><span class="hl-1">.</span><span class="hl-7">F_OK</span><span class="hl-1">, (</span><span class="hl-3">err</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">err</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-4">`File </span><span class="hl-2">${</span><span class="hl-3">filename</span><span class="hl-2">}</span><span class="hl-4"> does not exist`</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-4">`Starting to watch file </span><span class="hl-2">${</span><span class="hl-3">filename</span><span class="hl-2">}</span><span class="hl-4">`</span><span class="hl-1">);</span><br/><br/><span class="hl-1">      </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">watcher</span><span class="hl-1"> = </span><span class="hl-3">fs</span><span class="hl-1">.</span><span class="hl-6">watch</span><span class="hl-1">(</span><span class="hl-3">process</span><span class="hl-1">.</span><span class="hl-3">argv</span><span class="hl-1">[</span><span class="hl-5">2</span><span class="hl-1">]);</span><br/><br/><span class="hl-1">      </span><span class="hl-3">watcher</span><span class="hl-1">.</span><span class="hl-6">on</span><span class="hl-1">(</span><span class="hl-4">&#39;change&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-4">`File </span><span class="hl-2">${</span><span class="hl-3">filename</span><span class="hl-2">}</span><span class="hl-4"> has been modified somehow`</span><span class="hl-1">);</span><br/><span class="hl-1">      });</span><br/><br/><span class="hl-1">      </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-4">`File </span><span class="hl-2">${</span><span class="hl-3">filename</span><span class="hl-2">}</span><span class="hl-4"> is no longer watched`</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">}</span>
</code></pre>
<p>Con el objetivo de explicar durante la traza que suecede con el contenido de la pila de llamadas, el registro de eventos de la API y la cola de manejadores. Además se pide realizar dos modificaciones al fichero que se le pasa a la función y mostrar el contenido impreso en consola.</p>

<a href="#explicación-del-código" id="explicación-del-código" style="color: inherit; text-decoration: none;">
  <h4>Explicación del código</h4>
</a>
<p>Entendiendo el código lo esperado es que si se ha indicado correctamente el fichero que se va a analizar, primero se muestre el mensaje</p>
<pre><code class="language-ts"><span class="hl-4">`File </span><span class="hl-2">${</span><span class="hl-3">filename</span><span class="hl-2">}</span><span class="hl-4"> does not exist`</span>
</code></pre>
<p>Tras esto, lo esperado es que se espere una modificacion en el fichero y tras cada modificacion se notifique por consola de ello y finalmente mostrar el mensaje </p>
<pre><code class="language-ts"><span class="hl-4">`File </span><span class="hl-2">${</span><span class="hl-3">filename</span><span class="hl-2">}</span><span class="hl-4"> is no longer watched`</span>
</code></pre>
<p>Sin embargo, la realidad es muy diferente, atendiendo a que la impresión por consola del mensaje final es síncrono y el <em>fs.watcher</em> es asíncrono, mientras este segundo espera un cambio en el fichero se esta procesando en la call stack el <em>console log</em> del mensaje final. Por lo que el funcionamiento del programa no es el deseado, una vez procesado el primer <em>console log</em> en el web api se queda esperando a cambios en el fichero, mientras que el texto final ya ha sido ejecutado.</p>

<a href="#ejecución-del-código" id="ejecución-del-código" style="color: inherit; text-decoration: none;">
  <h4>Ejecución del código</h4>
</a>
<p>Se ha ejecutado el código y se han llevado a cabo dos modificaciones del fichero <em>&#39;helloworld.txt&#39;</em> el cual se ha pasado como argumento al programa. El resultado ha sido el siguiente:</p>
<pre><code class="language-console"><span class="hl-3">$node</span><span class="hl-1"> ./dist/Ejercicio1-debug/readfile.js helloworld.txt </span><br/><span class="hl-1">Starting </span><span class="hl-4">to</span><span class="hl-1"> </span><span class="hl-4">watch</span><span class="hl-1"> </span><span class="hl-4">file</span><span class="hl-1"> </span><span class="hl-4">helloworld.txt</span><br/><span class="hl-1">File </span><span class="hl-4">helloworld.txt</span><span class="hl-1"> </span><span class="hl-4">is</span><span class="hl-1"> </span><span class="hl-4">no</span><span class="hl-1"> </span><span class="hl-4">longer</span><span class="hl-1"> </span><span class="hl-4">watched</span><br/><span class="hl-1">File </span><span class="hl-4">helloworld.txt</span><span class="hl-1"> </span><span class="hl-4">has</span><span class="hl-1"> </span><span class="hl-4">been</span><span class="hl-1"> </span><span class="hl-4">modified</span><span class="hl-1"> </span><span class="hl-4">somehow</span><br/><span class="hl-1">File </span><span class="hl-4">helloworld.txt</span><span class="hl-1"> </span><span class="hl-4">has</span><span class="hl-1"> </span><span class="hl-4">been</span><span class="hl-1"> </span><span class="hl-4">modified</span><span class="hl-1"> </span><span class="hl-4">somehow</span><br/><span class="hl-1">File </span><span class="hl-4">helloworld.txt</span><span class="hl-1"> </span><span class="hl-4">has</span><span class="hl-1"> </span><span class="hl-4">been</span><span class="hl-1"> </span><span class="hl-4">modified</span><span class="hl-1"> </span><span class="hl-4">somehow</span><br/><span class="hl-1">File </span><span class="hl-4">helloworld.txt</span><span class="hl-1"> </span><span class="hl-4">has</span><span class="hl-1"> </span><span class="hl-4">been</span><span class="hl-1"> </span><span class="hl-4">modified</span><span class="hl-1"> </span><span class="hl-4">somehow</span><br/><span class="hl-1">File </span><span class="hl-4">helloworld.txt</span><span class="hl-1"> </span><span class="hl-4">has</span><span class="hl-1"> </span><span class="hl-4">been</span><span class="hl-1"> </span><span class="hl-4">modified</span><span class="hl-1"> </span><span class="hl-4">somehow</span>
</code></pre>

<a href="#función-fsacces" id="función-fsacces" style="color: inherit; text-decoration: none;">
  <h4>Función <em>fs.acces()</em></h4>
</a>
<p>El método access se usa para comprobar los permisos de un archivo o directorio. Estos permisos se pueden especificar mediante una constante (<em>&#39;constant&#39;</em>) pasada como segundo parámetro. Mencionar que pueden concatenarse varios permisos mediante el operador <em>OR</em> lógico.</p>
<p>En cuanto a la sintaxis del método podemos ver que se requieren los siguientes parámetros:</p>
<pre><code class="language-ts"><span class="hl-3">fs</span><span class="hl-1">.</span><span class="hl-6">access</span><span class="hl-1"> (</span><span class="hl-3">path</span><span class="hl-1">, </span><span class="hl-3">mode</span><span class="hl-1">, </span><span class="hl-3">callback</span><span class="hl-1">).</span>
</code></pre>
<ol>
<li><p><strong>Path:</strong> Es la ruta hasta el fichero/directorio que se desea comprobar.</p>
</li>
<li><p><strong>Mode:</strong> Aquí es donde se emplea el fs.constant.F_OK en nuestro programa, mediante este parámetro se decide que permisos se quieren comprobar, el F_OK es el valor por defecto, pero también hay otros valores como W_OK, R_OK, etc. Y como se mencionó anteriormente pueden ser concatenados mediante el operador lógio <em>OR</em>.</p>
</li>
<li><p><strong>Callback:</strong> Es una funcion llamada durante la ejecucion del método, en nuestro ejemplo se utiliza para comprobar la existencia del fichero que se está examinando.</p>
</li>
</ol>

<a href="#ejercicio-2" id="ejercicio-2" style="color: inherit; text-decoration: none;">
  <h3><strong>Ejercicio 2:</strong></h3>
</a>
<p>Se nos ha solicitado desarrollar una aplicación la cual se encargue de leer el numero de lineas, palabras y carácteres de un fichero.</p>
<p>A esta aplicación se le pasa por parámetro el nombre del fichero a examinar y trees booleanos decidiendo que se desea contar. Para el manejo del los parametros de entrada se ha hecho uso del paquete <em><a href="https://www.npmjs.com/package/yargs">yargs</a></em>. Tal como se puede ver a continuación:</p>
<pre><code class="language-ts"><span class="hl-6">yargs</span><span class="hl-1">(</span><span class="hl-6">hideBin</span><span class="hl-1">(</span><span class="hl-3">process</span><span class="hl-1">.</span><span class="hl-3">argv</span><span class="hl-1">))</span><br/><span class="hl-1">.</span><span class="hl-6">command</span><span class="hl-1">(</span><span class="hl-4">&#39;read&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;Reads a file&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-3">file:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;File path&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-3">lines:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;File lines&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;boolean&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-3">words:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;File words&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;boolean&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-3">chars:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;File chars&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;boolean&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">} , (</span><span class="hl-3">argv</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">checkFileExistsSync</span><span class="hl-1">(</span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">file</span><span class="hl-1">)) {</span><br/><span class="hl-1">    </span><span class="hl-8">// console.log(&#39;File exists&#39;);</span><br/><span class="hl-1">    </span><span class="hl-6">run</span><span class="hl-1">(</span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">file</span><span class="hl-1">, </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">lines</span><span class="hl-1">, </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">words</span><span class="hl-1">, </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">chars</span><span class="hl-1">);</span><br/><span class="hl-1">  } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">chalk</span><span class="hl-1">.</span><span class="hl-3">red</span><span class="hl-1">.</span><span class="hl-6">bold</span><span class="hl-1">(</span><span class="hl-4">&#39;File does not exist, please try again&#39;</span><span class="hl-1">));</span><br/><span class="hl-1">    </span><span class="hl-6">exit</span><span class="hl-1">(</span><span class="hl-5">0</span><span class="hl-1">)</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">})</span><br/><span class="hl-1">.</span><span class="hl-6">help</span><span class="hl-1">()</span><br/><span class="hl-1">.</span><span class="hl-3">argv</span><span class="hl-1">;</span>
</code></pre>

<a href="#usando-el-método-pipe" id="usando-el-método-pipe" style="color: inherit; text-decoration: none;">
  <h4><strong>Usando el método pipe</strong></h4>
</a>
<p>Mencionar que antes de llamar a la funcion <em>run()</em> se comprueba si el fichero existe, en caso contrario se emite un mensaje de error en consola.</p>
<p>Asimismo, se nos ha solicitado realizar de dos maneras diferentes esta aplicación, en primer lugar, se nos solicita realizarla haciendo uso del método <em>pipe</em> de un <em>Stream</em>. </p>
<p>Mi propuesta ha sido la siguiente:</p>
<pre><code class="language-ts"><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">function</span><span class="hl-1"> </span><span class="hl-6">run</span><span class="hl-1">(</span><span class="hl-3">file</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">, </span><span class="hl-3">lines</span><span class="hl-1">: </span><span class="hl-9">boolean</span><span class="hl-1">, </span><span class="hl-3">words</span><span class="hl-1">: </span><span class="hl-9">boolean</span><span class="hl-1">, </span><span class="hl-3">chars</span><span class="hl-1">:</span><span class="hl-9">boolean</span><span class="hl-1">): </span><span class="hl-9">void</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-8">// Al menos debe existir una de las opciones que se pasan por parámetro</span><br/><span class="hl-1">  </span><span class="hl-8">// Controlamos que almenos un valor es true, por ende, si todas son false, emitimos mensaje de error y cerramos</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-3">lines</span><span class="hl-1"> &amp;&amp; !</span><span class="hl-3">words</span><span class="hl-1"> &amp;&amp; !</span><span class="hl-3">chars</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">chalk</span><span class="hl-1">.</span><span class="hl-6">red</span><span class="hl-1">(</span><span class="hl-4">&#39;Error: Al menos debe existir una de las opciones que se pasan por parámetro&#39;</span><span class="hl-1">));</span><br/><span class="hl-1">    </span><span class="hl-3">process</span><span class="hl-1">.</span><span class="hl-6">exit</span><span class="hl-1">(</span><span class="hl-5">0</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">stdoutArr</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">[] = [];</span><br/><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">lines</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-3">stdoutArr</span><span class="hl-1">.</span><span class="hl-6">push</span><span class="hl-1">(</span><span class="hl-4">&#39;-l&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  } </span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">words</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-3">stdoutArr</span><span class="hl-1">.</span><span class="hl-6">push</span><span class="hl-1">(</span><span class="hl-4">&#39;-w&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">chars</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-3">stdoutArr</span><span class="hl-1">.</span><span class="hl-6">push</span><span class="hl-1">(</span><span class="hl-4">&#39;-m&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-3">stdoutArr</span><span class="hl-1">.</span><span class="hl-6">push</span><span class="hl-1">(</span><span class="hl-3">file</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">wc</span><span class="hl-1"> = </span><span class="hl-6">spawn</span><span class="hl-1">(</span><span class="hl-4">&#39;wc&#39;</span><span class="hl-1">, </span><span class="hl-3">stdoutArr</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-3">wc</span><span class="hl-1">.</span><span class="hl-3">stdout</span><span class="hl-1">.</span><span class="hl-6">pipe</span><span class="hl-1">(</span><span class="hl-3">process</span><span class="hl-1">.</span><span class="hl-3">stdout</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code></pre>
<p>Tal y como se puede observar por cuestiones de programación defensiva primero se comprueba que los tres parámetros no sean <em>false</em>, debido a que si se desea usar la aplicación es para contar uno de los 3 parámetros que lee el comando wc. En caso de que no se supere el filtro se emite un mensaje de error por consola.</p>
<p>Tras este filtro, se genera un array de cadenas en el cual se van a meter los parámetros que se le van a enviar al comando wc. Esto se gestiona mediante tres filtros en los cuales se comprueban tres valores booleanos; <em>lines</em>, <em>words</em> y <em>chars</em>, y se va concatenando al array de cadenas los parametros que se desean ver.</p>
<p>Finalmente creamos un nuevo proceso mediante <em>spawn</em> que recibe como primer parámetro el nombre del comando a ejecutar y en segundo lugar, un array con los parámetros que se van a examinar y el nombre del fichero que se va a leer. Tras esto tal y como se nos pide redirigimos la salida del proceso mediante el método <em>pipe</em> de un stream.</p>

<a href="#sin-hacer-uso-del-pipe" id="sin-hacer-uso-del-pipe" style="color: inherit; text-decoration: none;">
  <h4><strong>Sin hacer uso del pipe</strong></h4>
</a>
<p>En segundo lugar, se solicita desarrollar la misma app pero sin usar el método <em>pipe</em>. En su lugar se crea un subproceso y se hace uso de los maneajores &#39;data&#39; y &#39;close&#39; para llevar a cabo su ejecución.</p>
<p>Mi propuesta ha sido la siguiente:</p>
<pre><code class="language-ts"><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">function</span><span class="hl-1"> </span><span class="hl-6">run</span><span class="hl-1">(</span><span class="hl-3">file</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">, </span><span class="hl-3">lines</span><span class="hl-1">: </span><span class="hl-9">boolean</span><span class="hl-1">, </span><span class="hl-3">words</span><span class="hl-1">: </span><span class="hl-9">boolean</span><span class="hl-1">, </span><span class="hl-3">chars</span><span class="hl-1">:</span><span class="hl-9">boolean</span><span class="hl-1">): </span><span class="hl-9">void</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-8">// Al menos debe existir una de las opciones que se pasan por parámetro</span><br/><span class="hl-1">  </span><span class="hl-8">// Controlamos que almenos un valor es true, por ende, si todas son false, emitimos mensaje de error y cerramos</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-3">lines</span><span class="hl-1"> &amp;&amp; !</span><span class="hl-3">words</span><span class="hl-1"> &amp;&amp; !</span><span class="hl-3">chars</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">chalk</span><span class="hl-1">.</span><span class="hl-6">red</span><span class="hl-1">(</span><span class="hl-4">&#39;Error: Al menos debe existir una de las opciones que se pasan por parámetro&#39;</span><span class="hl-1">));</span><br/><span class="hl-1">    </span><span class="hl-3">process</span><span class="hl-1">.</span><span class="hl-6">exit</span><span class="hl-1">(</span><span class="hl-5">0</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">wc</span><span class="hl-1"> = </span><span class="hl-6">spawn</span><span class="hl-1">(</span><span class="hl-4">&#39;wc&#39;</span><span class="hl-1">, [</span><span class="hl-3">file</span><span class="hl-1">]);</span><br/><span class="hl-1">  </span><span class="hl-2">let</span><span class="hl-1"> </span><span class="hl-3">wcOutput</span><span class="hl-1"> = </span><span class="hl-4">&#39;&#39;</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-3">wc</span><span class="hl-1">.</span><span class="hl-3">stdout</span><span class="hl-1">.</span><span class="hl-6">on</span><span class="hl-1">(</span><span class="hl-4">&#39;data&#39;</span><span class="hl-1">, (</span><span class="hl-3">piece</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-3">wcOutput</span><span class="hl-1"> += </span><span class="hl-3">piece</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-3">wc</span><span class="hl-1">.</span><span class="hl-6">on</span><span class="hl-1">(</span><span class="hl-4">&#39;close&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">wcOutputAsArray</span><span class="hl-1"> = </span><span class="hl-3">wcOutput</span><span class="hl-1">.</span><span class="hl-6">split</span><span class="hl-1">(</span><span class="hl-10">/\s</span><span class="hl-11">+</span><span class="hl-10">/</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">lines</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">numberOfLines</span><span class="hl-1"> = +</span><span class="hl-3">wcOutputAsArray</span><span class="hl-1">[</span><span class="hl-5">1</span><span class="hl-1">] + </span><span class="hl-5">1</span><span class="hl-1"> ;</span><br/><span class="hl-1">      </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-4">`File </span><span class="hl-2">${</span><span class="hl-3">file</span><span class="hl-2">}</span><span class="hl-4"> has `</span><span class="hl-1"> + </span><span class="hl-3">numberOfLines</span><span class="hl-1"> + </span><span class="hl-4">` lines`</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">words</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-4">`File </span><span class="hl-2">${</span><span class="hl-3">file</span><span class="hl-2">}</span><span class="hl-4"> has </span><span class="hl-2">${</span><span class="hl-3">wcOutputAsArray</span><span class="hl-12">[</span><span class="hl-5">2</span><span class="hl-12">]</span><span class="hl-2">}</span><span class="hl-4"> words`</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">chars</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-4">`File </span><span class="hl-2">${</span><span class="hl-3">file</span><span class="hl-2">}</span><span class="hl-4"> has </span><span class="hl-2">${</span><span class="hl-3">wcOutputAsArray</span><span class="hl-12">[</span><span class="hl-5">3</span><span class="hl-12">]</span><span class="hl-2">}</span><span class="hl-4"> characters`</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">}</span>
</code></pre>
<p>Primero se realiza la misma comprobación que en el ejemplo anterior.</p>
<p>Luego se genera un subproceso mediante spawn al cual se le pasa como primer parámetro el comando <em>wc</em> y un array con el nombre del fichero que se desea ejecutar.</p>
<p>A continuación, mediante el evento <em>on.(&#39;data&#39;)</em> almacenamos el resultado del comando en un array de cadenas y finalmente, con el evento <em>on.(&#39;close&#39;)</em> una vez se ha leido el fichero mostramos por consola el contenido que el usuario desea ver.</p>

<a href="#ejercicio-3" id="ejercicio-3" style="color: inherit; text-decoration: none;">
  <h3><strong>Ejercicio 3:</strong></h3>
</a>
<p>Se nos ha solicitado realizar una modificación a la aplicación desarrollada en la práctica anterior. En este caso se debe establecer un patrón petición-respuesta entre cliente y servidor en la cual el cliente se conecta al servidor y le hace un request con un comando, el servidor lo procesa y le devuelve el resultado a este. Ese resultado se procesa y se imprime en consola.</p>
<p>Asimismo toda la lógica de ficheros en el servidor debe llevarse a cabo mediante APIs asíncronas de NODE.js.</p>
<p>Mi propuesta ha sido la siguiente:</p>

<a href="#cliente" id="cliente" style="color: inherit; text-decoration: none;">
  <h4>Cliente:</h4>
</a>
<p>En la parte del cliente se ha llevado a cabo la recepcion de comandos mediante el uso del paquete yargs, tal y como se puede ver a continuación:</p>
<pre><code class="language-ts"><span class="hl-2">let</span><span class="hl-1"> </span><span class="hl-3">jsonData</span><span class="hl-1">: </span><span class="hl-9">Funko</span><span class="hl-1">;</span><br/><span class="hl-2">let</span><span class="hl-1"> </span><span class="hl-3">request</span><span class="hl-1">: </span><span class="hl-9">RequestType</span><span class="hl-1">;</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * </span><span class="hl-2">@description</span><span class="hl-8"> Comando para añadir un Funko</span><br/><span class="hl-8">*/</span><br/><span class="hl-6">yargs</span><span class="hl-1">(</span><span class="hl-6">hideBin</span><span class="hl-1">(</span><span class="hl-3">process</span><span class="hl-1">.</span><span class="hl-3">argv</span><span class="hl-1">))</span><br/><span class="hl-1">.</span><span class="hl-6">command</span><span class="hl-1">(</span><span class="hl-4">&#39;add&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;Adds a funko&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-3">user:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;User name&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">, </span><span class="hl-8">// obligatorio</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-3">id:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;Funko id&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;number&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-3">name:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;Funko name&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-3">description:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;Funko description&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-3">type:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;Funko type&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-3">genre:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;Funko genre&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-3">franchise:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;Funko franchise&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-3">franchise_number:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;Funko franchise number&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;number&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-3">exclusive:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;Funko exclusive&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;boolean&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-3">espCar:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;Funko especial Caracteristics&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-3">price:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;Funko price&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;number&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }, (</span><span class="hl-3">argv</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">jsonData</span><span class="hl-1"> = {</span><br/><span class="hl-1">      </span><span class="hl-3">_id:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">id</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">_name:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">name</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">_description:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">description</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">_type:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">type</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-9">Funko_type</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">_genre:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">genre</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-9">Funko_genre</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">_franchise:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">franchise</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">_franchise_number:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">franchise_number</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">_exclusive:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">exclusive</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">_especialCaracteristics:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">espCar</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">_price:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">price</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">    </span><span class="hl-3">request</span><span class="hl-1"> = {</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;add&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">user:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">user</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">message:</span><span class="hl-1"> </span><span class="hl-3">jsonData</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }).</span><span class="hl-6">help</span><span class="hl-1">().</span><span class="hl-3">argv</span><br/><br/><span class="hl-1">  </span><span class="hl-8">/**</span><br/><span class="hl-8">   * </span><span class="hl-2">@description</span><span class="hl-8"> Comando para actualizar el contenido de un Funko</span><br/><span class="hl-8">   */</span><br/><span class="hl-6">yargs</span><span class="hl-1">(</span><span class="hl-6">hideBin</span><span class="hl-1">(</span><span class="hl-3">process</span><span class="hl-1">.</span><span class="hl-3">argv</span><span class="hl-1">))</span><br/><span class="hl-1">  .</span><span class="hl-6">command</span><span class="hl-1">(</span><span class="hl-4">&#39;update&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;Modify funko content&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">    </span><span class="hl-3">user:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;User name&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">, </span><span class="hl-8">// obligatorio</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-3">id:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;Funko id&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;number&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-3">name:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;Funko name&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-3">description:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;Funko description&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-3">type:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;Funko type&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-3">genre:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;Funko genre&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-3">franchise:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;Funko franchise&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-3">franchise_number:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;Funko franchise number&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;number&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-3">exclusive:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;Funko exclusive&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;boolean&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-3">espCar:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;Funko especial Caracteristics&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-3">price:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;Funko price&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;number&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }, (</span><span class="hl-3">argv</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">jsonData</span><span class="hl-1"> = {</span><br/><span class="hl-1">      </span><span class="hl-3">_id:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">id</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">_name:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">name</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">_description:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">description</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">_type:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">type</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-9">Funko_type</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">_genre:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">genre</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-9">Funko_genre</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">_franchise:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">franchise</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">_franchise_number:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">franchise_number</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">_exclusive:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">exclusive</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">_especialCaracteristics:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">espCar</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">_price:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">price</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">    </span><span class="hl-3">request</span><span class="hl-1"> = {</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;update&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">user:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">user</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">message:</span><span class="hl-1"> </span><span class="hl-3">jsonData</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }).</span><span class="hl-6">help</span><span class="hl-1">().</span><span class="hl-3">argv</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * </span><span class="hl-2">@description</span><span class="hl-8"> Comando para eliminar un Funko</span><br/><span class="hl-8"> */</span><br/><span class="hl-6">yargs</span><span class="hl-1">(</span><span class="hl-6">hideBin</span><span class="hl-1">(</span><span class="hl-3">process</span><span class="hl-1">.</span><span class="hl-3">argv</span><span class="hl-1">))</span><br/><span class="hl-1">  .</span><span class="hl-6">command</span><span class="hl-1">(</span><span class="hl-4">&#39;remove&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;Remove a funko from an user collection&#39;</span><span class="hl-1">, { </span><br/><span class="hl-1">    </span><span class="hl-3">user:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;User name&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-3">id:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;Funko id&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;number&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }, (</span><span class="hl-3">argv</span><span class="hl-1">)</span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">jsonData</span><span class="hl-1"> = {</span><br/><span class="hl-1">      </span><span class="hl-3">_id:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">id</span><span class="hl-1">,</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">    </span><span class="hl-3">request</span><span class="hl-1"> = {</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;remove&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">user:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">user</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">message:</span><span class="hl-1"> </span><span class="hl-3">jsonData</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }).</span><span class="hl-6">help</span><span class="hl-1">().</span><span class="hl-3">argv</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * </span><span class="hl-2">@description</span><span class="hl-8"> Comando para listar todos los Funkos de un usuario</span><br/><span class="hl-8"> */</span><br/><span class="hl-6">yargs</span><span class="hl-1">(</span><span class="hl-6">hideBin</span><span class="hl-1">(</span><span class="hl-3">process</span><span class="hl-1">.</span><span class="hl-3">argv</span><span class="hl-1">))</span><br/><span class="hl-1">  .</span><span class="hl-6">command</span><span class="hl-1">(</span><span class="hl-4">&#39;list&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;List all funkos&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">    </span><span class="hl-3">user:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;User name&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">, </span><span class="hl-8">// obligatorio</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }, (</span><span class="hl-3">argv</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">jsonData</span><span class="hl-1"> = {}</span><br/><span class="hl-1">    </span><span class="hl-3">request</span><span class="hl-1"> = {</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;list&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">user:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">user</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">message:</span><span class="hl-1"> </span><span class="hl-3">jsonData</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }).</span><span class="hl-6">help</span><span class="hl-1">().</span><span class="hl-3">argv</span><br/><br/><span class="hl-8">/**</span><br/><span class="hl-8"> * </span><span class="hl-2">@description</span><span class="hl-8"> Comando para mostrar el contenido de un funko en concreto</span><br/><span class="hl-8"> */</span><br/><span class="hl-6">yargs</span><span class="hl-1">(</span><span class="hl-6">hideBin</span><span class="hl-1">(</span><span class="hl-3">process</span><span class="hl-1">.</span><span class="hl-3">argv</span><span class="hl-1">))</span><br/><span class="hl-1">  .</span><span class="hl-6">command</span><span class="hl-1">(</span><span class="hl-4">&#39;read&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;Find a funko in user folder by ID.&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">    </span><span class="hl-3">user:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;User name&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-3">id:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">description:</span><span class="hl-1"> </span><span class="hl-4">&#39;Funko id&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;number&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">demandOption:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }, (</span><span class="hl-3">argv</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">jsonData</span><span class="hl-1"> = {</span><br/><span class="hl-1">      </span><span class="hl-3">_id:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">id</span><span class="hl-1">,</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">    </span><span class="hl-3">request</span><span class="hl-1"> = {</span><br/><span class="hl-1">      </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;read&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">user:</span><span class="hl-1"> </span><span class="hl-3">argv</span><span class="hl-1">.</span><span class="hl-3">user</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-3">message:</span><span class="hl-1"> </span><span class="hl-3">jsonData</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }).</span><span class="hl-6">help</span><span class="hl-1">().</span><span class="hl-3">argv</span>
</code></pre>
<p>Cada comando tiene sus propios argumentos de caracter obligatorio y con estos se construye un objeto json y se forma el request type que se le enviará al servidor.</p>
<p>Tras esto se desarrolla el cliente utilizando la clase MessageEventEmitterClient, que como se puede ver a continuación:</p>
<pre><code class="language-ts"><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">class</span><span class="hl-1"> </span><span class="hl-9">MessageEventEmitterClient</span><span class="hl-1"> </span><span class="hl-2">extends</span><span class="hl-1"> </span><span class="hl-9">EventEmitter</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">private</span><span class="hl-1"> </span><span class="hl-3">socket</span><span class="hl-1">: </span><span class="hl-9">net</span><span class="hl-1">.</span><span class="hl-9">Socket</span><span class="hl-1">;</span><br/><br/><span class="hl-1">  </span><span class="hl-2">constructor</span><span class="hl-1">(</span><span class="hl-2">private</span><span class="hl-1"> </span><span class="hl-3">port</span><span class="hl-1">: </span><span class="hl-9">number</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-8">// console.log(&quot;SE HA CREADO LA CLASE CLIENTE&quot;);</span><br/><span class="hl-1">    </span><span class="hl-2">super</span><span class="hl-1">();</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">connect</span><span class="hl-1">();</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-8">/**</span><br/><span class="hl-8">   * </span><span class="hl-2">@description</span><span class="hl-8"> Método que conecta el cliente al servidor y establece los eventos</span><br/><span class="hl-8">   */</span><br/><span class="hl-1">  </span><span class="hl-6">connect</span><span class="hl-1">(): </span><span class="hl-9">void</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-8">// console.log(&quot;SE HA LLAMADO AL METODO CONNECT&quot;);</span><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-3">socket</span><span class="hl-1"> = </span><span class="hl-3">net</span><span class="hl-1">.</span><span class="hl-6">connect</span><span class="hl-1">({</span><span class="hl-3">port:</span><span class="hl-1"> </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-3">port</span><span class="hl-1"> }, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-4">&#39;Conexión establecida con el servidor&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">emit</span><span class="hl-1">(</span><span class="hl-4">&#39;connect&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-3">socket</span><span class="hl-1">.</span><span class="hl-6">on</span><span class="hl-1">(</span><span class="hl-4">&#39;data&#39;</span><span class="hl-1">, (</span><span class="hl-3">data</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">emit</span><span class="hl-1">(</span><span class="hl-4">&#39;message&#39;</span><span class="hl-1">, </span><span class="hl-3">data</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-3">socket</span><span class="hl-1">.</span><span class="hl-6">on</span><span class="hl-1">(</span><span class="hl-4">&#39;close&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">emit</span><span class="hl-1">(</span><span class="hl-4">&#39;disconnect&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><br/><span class="hl-1">    </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-3">socket</span><span class="hl-1">.</span><span class="hl-6">on</span><span class="hl-1">(</span><span class="hl-4">&#39;error&#39;</span><span class="hl-1">, (</span><span class="hl-3">err</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-6">emit</span><span class="hl-1">(</span><span class="hl-4">&#39;error&#39;</span><span class="hl-1">, </span><span class="hl-3">err</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-8">/**</span><br/><span class="hl-8">   * </span><span class="hl-2">@description</span><span class="hl-8"> Método que envía un mensaje al servidor</span><br/><span class="hl-8">   * </span><span class="hl-2">@param</span><span class="hl-8"> </span><span class="hl-3">message</span><span class="hl-8"> </span><br/><span class="hl-8">   */</span><br/><span class="hl-1">  </span><span class="hl-6">sendMessage</span><span class="hl-1">(</span><span class="hl-3">message</span><span class="hl-1">: </span><span class="hl-9">RequestType</span><span class="hl-1">): </span><span class="hl-9">void</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-3">socket</span><span class="hl-1"> || </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-3">socket</span><span class="hl-1">.</span><span class="hl-3">destroyed</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-0">throw</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-6">Error</span><span class="hl-1">(</span><span class="hl-4">&#39;El cliente no está conectado al servidor&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">    </span><span class="hl-8">// console.log(JSON.stringify(message));</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">stringMessage</span><span class="hl-1"> = </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-6">stringify</span><span class="hl-1">(</span><span class="hl-3">message</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-8">//! SOLVENTAR ERROR DE LA COMPILACION TSC</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">stringMessage</span><span class="hl-1">) { </span><span class="hl-8">// si el mensaje es null o undefined no lo enviamos</span><br/><span class="hl-1">      </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-3">socket</span><span class="hl-1">.</span><span class="hl-6">write</span><span class="hl-1">(</span><span class="hl-3">stringMessage</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-8">/**</span><br/><span class="hl-8">   * </span><span class="hl-2">@description</span><span class="hl-8"> Método que desconecta el cliente del servidor</span><br/><span class="hl-8">   * </span><span class="hl-2">@description</span><span class="hl-8"> [Doc](https://nodejs.org/api/net.html#socketdestroyed)</span><br/><span class="hl-8">   */</span><br/><span class="hl-1">  </span><span class="hl-6">disconnect</span><span class="hl-1">(): </span><span class="hl-9">void</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-3">socket</span><span class="hl-1"> &amp;&amp; !</span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-3">socket</span><span class="hl-1">.</span><span class="hl-3">destroyed</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-2">this</span><span class="hl-1">.</span><span class="hl-3">socket</span><span class="hl-1">.</span><span class="hl-6">end</span><span class="hl-1">();</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code></pre>
<p>Es una clase que hereda de la clase <em>eventEmitter</em>, sus únicos atributos privados son el socket del módulo net y el puerto que esta escuchando el servidor. Asimismo esta clase tiene 3 métodos. En primer lugar, <em>connect()</em> el cual lleva a cabo la conexión con el servidor y le emite al cliente los eventos que le le lanza el servidor, luego, <em>sendMessage()</em> utilizado para enviarle al servidor un request y por último, <em>disconnect</em> el cual cierra la conexión con el servidor.</p>
<p>Además, comentar el siguiente fragmento de código:</p>
<pre><code class="language-ts"><span class="hl-3">client</span><span class="hl-1">.</span><span class="hl-6">on</span><span class="hl-1">(</span><span class="hl-4">&#39;connect&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-8">// console.log(&#39;Conexión establecida con el servidor&#39;);</span><br/><span class="hl-1">  </span><span class="hl-3">client</span><span class="hl-1">.</span><span class="hl-6">sendMessage</span><span class="hl-1">(</span><span class="hl-3">request</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-3">client</span><span class="hl-1">.</span><span class="hl-6">on</span><span class="hl-1">(</span><span class="hl-4">&#39;message&#39;</span><span class="hl-1">, (</span><span class="hl-3">message</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">response</span><span class="hl-1"> = </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-6">parse</span><span class="hl-1">(</span><span class="hl-3">message</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-0">switch</span><span class="hl-1"> (</span><span class="hl-3">response</span><span class="hl-1">.</span><span class="hl-3">type</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-4">&#39;add&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">response</span><span class="hl-1">.</span><span class="hl-3">success</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">chalk</span><span class="hl-1">.</span><span class="hl-3">green</span><span class="hl-1">.</span><span class="hl-6">bold</span><span class="hl-1">(</span><span class="hl-3">response</span><span class="hl-1">.</span><span class="hl-3">message</span><span class="hl-1">));</span><br/><span class="hl-1">      } </span><span class="hl-0">else</span><span class="hl-1"> { </span><br/><span class="hl-1">        </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">chalk</span><span class="hl-1">.</span><span class="hl-3">red</span><span class="hl-1">.</span><span class="hl-6">bold</span><span class="hl-1">(</span><span class="hl-3">response</span><span class="hl-1">.</span><span class="hl-3">message</span><span class="hl-1">));</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">      </span><span class="hl-0">break</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-4">&#39;update&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">response</span><span class="hl-1">.</span><span class="hl-3">success</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">chalk</span><span class="hl-1">.</span><span class="hl-3">green</span><span class="hl-1">.</span><span class="hl-6">bold</span><span class="hl-1">(</span><span class="hl-3">response</span><span class="hl-1">.</span><span class="hl-3">message</span><span class="hl-1">));</span><br/><span class="hl-1">      } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">chalk</span><span class="hl-1">.</span><span class="hl-3">red</span><span class="hl-1">.</span><span class="hl-6">bold</span><span class="hl-1">(</span><span class="hl-3">response</span><span class="hl-1">.</span><span class="hl-3">message</span><span class="hl-1">));</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">      </span><span class="hl-0">break</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-4">&#39;remove&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">response</span><span class="hl-1">.</span><span class="hl-3">success</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">chalk</span><span class="hl-1">.</span><span class="hl-3">green</span><span class="hl-1">.</span><span class="hl-6">bold</span><span class="hl-1">(</span><span class="hl-3">response</span><span class="hl-1">.</span><span class="hl-3">message</span><span class="hl-1">));</span><br/><span class="hl-1">      } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">chalk</span><span class="hl-1">.</span><span class="hl-3">red</span><span class="hl-1">.</span><span class="hl-6">bold</span><span class="hl-1">(</span><span class="hl-3">response</span><span class="hl-1">.</span><span class="hl-3">message</span><span class="hl-1">));</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">      </span><span class="hl-0">break</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-4">&#39;list&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">response</span><span class="hl-1">.</span><span class="hl-3">success</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">chalk</span><span class="hl-1">.</span><span class="hl-3">green</span><span class="hl-1">.</span><span class="hl-6">bold</span><span class="hl-1">(</span><span class="hl-3">response</span><span class="hl-1">.</span><span class="hl-3">message</span><span class="hl-1">));</span><br/><span class="hl-1">        </span><span class="hl-2">let</span><span class="hl-1"> </span><span class="hl-3">counter</span><span class="hl-1"> = </span><span class="hl-5">0</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-0">for</span><span class="hl-1"> (</span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">funko</span><span class="hl-1"> </span><span class="hl-2">of</span><span class="hl-1"> </span><span class="hl-3">response</span><span class="hl-1">.</span><span class="hl-3">funkoPops</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-9">Funko</span><span class="hl-1">[]) {</span><br/><span class="hl-1">          </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">counter</span><span class="hl-1"> % </span><span class="hl-5">2</span><span class="hl-1"> == </span><span class="hl-5">0</span><span class="hl-1">) {</span><br/><span class="hl-1">            </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">chalk</span><span class="hl-1">.</span><span class="hl-3">gray</span><span class="hl-1">.</span><span class="hl-6">bold</span><span class="hl-1">(</span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-6">stringify</span><span class="hl-1">(</span><span class="hl-3">funko</span><span class="hl-1">)));</span><br/><span class="hl-1">          } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">chalk</span><span class="hl-1">.</span><span class="hl-3">yellow</span><span class="hl-1">.</span><span class="hl-6">bold</span><span class="hl-1">(</span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-6">stringify</span><span class="hl-1">(</span><span class="hl-3">funko</span><span class="hl-1">)));</span><br/><span class="hl-1">          }</span><br/><span class="hl-1">          </span><span class="hl-8">//console.log(&#39;\n&#39;);</span><br/><span class="hl-1">          </span><span class="hl-3">counter</span><span class="hl-1">++;</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">      } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">chalk</span><span class="hl-1">.</span><span class="hl-3">red</span><span class="hl-1">.</span><span class="hl-6">bold</span><span class="hl-1">(</span><span class="hl-3">response</span><span class="hl-1">.</span><span class="hl-3">message</span><span class="hl-1">));</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">      </span><span class="hl-0">break</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-4">&#39;read&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">response</span><span class="hl-1">.</span><span class="hl-3">success</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">chalk</span><span class="hl-1">.</span><span class="hl-3">green</span><span class="hl-1">.</span><span class="hl-6">bold</span><span class="hl-1">(</span><span class="hl-3">response</span><span class="hl-1">.</span><span class="hl-3">message</span><span class="hl-1">));</span><br/><span class="hl-1">        </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">funko</span><span class="hl-1"> = </span><span class="hl-3">response</span><span class="hl-1">.</span><span class="hl-3">funko</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-9">Funko</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">chalk</span><span class="hl-1">.</span><span class="hl-3">green</span><span class="hl-1">.</span><span class="hl-6">bold</span><span class="hl-1">(</span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-6">stringify</span><span class="hl-1">(</span><span class="hl-3">funko</span><span class="hl-1">)));</span><br/><span class="hl-1">      } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">chalk</span><span class="hl-1">.</span><span class="hl-3">red</span><span class="hl-1">.</span><span class="hl-6">bold</span><span class="hl-1">(</span><span class="hl-3">response</span><span class="hl-1">.</span><span class="hl-3">message</span><span class="hl-1">));</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">      </span><span class="hl-0">break</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-4">&#39;error&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">      </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">error</span><span class="hl-1">(</span><span class="hl-3">chalk</span><span class="hl-1">.</span><span class="hl-3">red</span><span class="hl-1">.</span><span class="hl-6">bold</span><span class="hl-1">(</span><span class="hl-3">response</span><span class="hl-1">.</span><span class="hl-3">message</span><span class="hl-1">));</span><br/><span class="hl-1">      </span><span class="hl-0">break</span><span class="hl-1">;</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-3">client</span><span class="hl-1">.</span><span class="hl-6">disconnect</span><span class="hl-1">();</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-3">client</span><span class="hl-1">.</span><span class="hl-6">on</span><span class="hl-1">(</span><span class="hl-4">&#39;disconnect&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">chalk</span><span class="hl-1">.</span><span class="hl-3">cyan</span><span class="hl-1">.</span><span class="hl-6">bold</span><span class="hl-1">(</span><span class="hl-4">&#39;Se ha desconectado del servidor&#39;</span><span class="hl-1">));</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-3">client</span><span class="hl-1">.</span><span class="hl-6">on</span><span class="hl-1">(</span><span class="hl-4">&#39;error&#39;</span><span class="hl-1">, (</span><span class="hl-3">err</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">error</span><span class="hl-1">(</span><span class="hl-4">`Error de conexión: </span><span class="hl-2">${</span><span class="hl-3">err</span><span class="hl-12">.</span><span class="hl-3">message</span><span class="hl-2">}</span><span class="hl-4">`</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code></pre>
<p>En el cual el cliente procesa la respuesta de tipo <em>response</em> que le envía el servidor. Para cada tipo de respuesta que pueda recepcionar el cliente se examina si ha sido satisfactorio en base al parámetro <em>succes</em> de la respuesta, emitiendo la respuesta del servidor en la terminal y un mensaje de error en caso contrario.</p>

<a href="#servidor" id="servidor" style="color: inherit; text-decoration: none;">
  <h4>Servidor:</h4>
</a>
<p>En cuanto a la parte del servidor se va a comentar el siguiente código:</p>
<pre><code class="language-ts"><span class="hl-2">let</span><span class="hl-1"> </span><span class="hl-3">response</span><span class="hl-1">: </span><span class="hl-9">ResponseType</span><span class="hl-1">;</span><br/><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">server</span><span class="hl-1"> = </span><span class="hl-3">net</span><span class="hl-1">.</span><span class="hl-6">createServer</span><span class="hl-1">((</span><span class="hl-3">socket</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">chalk</span><span class="hl-1">.</span><span class="hl-3">bold</span><span class="hl-1">.</span><span class="hl-6">green</span><span class="hl-1">(</span><span class="hl-4">&#39;Cliente conectado&#39;</span><span class="hl-1">));</span><br/><br/><span class="hl-1">  </span><span class="hl-3">socket</span><span class="hl-1">.</span><span class="hl-6">on</span><span class="hl-1">(</span><span class="hl-4">&#39;data&#39;</span><span class="hl-1">, (</span><span class="hl-3">data</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-8">// console.log(`Datos recibidos: ${data}`);</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">request</span><span class="hl-1"> = </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-6">parse</span><span class="hl-1">(</span><span class="hl-3">data</span><span class="hl-1">.</span><span class="hl-6">toString</span><span class="hl-1">())</span><br/><span class="hl-1">    </span><span class="hl-8">// console.log(request);</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">user</span><span class="hl-1">) { </span><span class="hl-8">// comprobamos que el parametro user no es nulo o undefined</span><br/><span class="hl-1">      </span><span class="hl-8">// comprobamos que el usuario existe en la BBDD</span><br/><span class="hl-1">      </span><span class="hl-6">userExistOnBD</span><span class="hl-1">(</span><span class="hl-4">`./database/</span><span class="hl-2">${</span><span class="hl-3">request</span><span class="hl-12">.</span><span class="hl-3">user</span><span class="hl-2">}</span><span class="hl-4">`</span><span class="hl-1">, (</span><span class="hl-3">exists</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">exists</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">ids</span><span class="hl-1"> = </span><span class="hl-6">getIds</span><span class="hl-1">(</span><span class="hl-4">`./database/</span><span class="hl-2">${</span><span class="hl-3">request</span><span class="hl-12">.</span><span class="hl-3">user</span><span class="hl-2">}</span><span class="hl-4">`</span><span class="hl-1">);</span><br/><span class="hl-1">          </span><span class="hl-8">// console.log(chalk.green.bold(&quot;El usuario existe&quot;));</span><br/><span class="hl-1">          </span><span class="hl-0">switch</span><span class="hl-1"> (</span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">type</span><span class="hl-1">) {</span><br/><span class="hl-1">            </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-4">&#39;add&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">              </span><span class="hl-8">// comprobamos que el id no existe en la BBDD</span><br/><span class="hl-1">              </span><span class="hl-0">if</span><span class="hl-1">(</span><span class="hl-3">ids</span><span class="hl-1">.</span><span class="hl-6">includes</span><span class="hl-1">(</span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">message</span><span class="hl-1">.</span><span class="hl-3">_id</span><span class="hl-1">)) {</span><br/><span class="hl-1">                </span><span class="hl-3">response</span><span class="hl-1"> = {</span><br/><span class="hl-1">                  </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;add&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">                  </span><span class="hl-3">success:</span><span class="hl-1"> </span><span class="hl-2">false</span><span class="hl-1">,</span><br/><span class="hl-1">                  </span><span class="hl-3">message:</span><span class="hl-1"> </span><span class="hl-4">&#39;El funko con id &#39;</span><span class="hl-1"> + </span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">message</span><span class="hl-1">.</span><span class="hl-3">_id</span><span class="hl-1"> + </span><span class="hl-4">&#39; ya existe en la BBDD del usuario &#39;</span><span class="hl-1"> + </span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">user</span><span class="hl-1"> </span><br/><span class="hl-1">                }</span><br/><span class="hl-1">                </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">responseString</span><span class="hl-1"> = </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-6">stringify</span><span class="hl-1">(</span><span class="hl-3">response</span><span class="hl-1">);</span><br/><span class="hl-1">                </span><span class="hl-3">socket</span><span class="hl-1">.</span><span class="hl-6">write</span><span class="hl-1">(</span><span class="hl-3">responseString</span><span class="hl-1">);</span><br/><span class="hl-1">              } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">                </span><span class="hl-6">createJsonFunkoFile</span><span class="hl-1">(</span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">user</span><span class="hl-1">, </span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">message</span><span class="hl-1">);</span><br/><span class="hl-1">                </span><span class="hl-3">response</span><span class="hl-1"> = {</span><br/><span class="hl-1">                  </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;add&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">                  </span><span class="hl-3">success:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">                  </span><span class="hl-3">message:</span><span class="hl-1"> </span><span class="hl-4">&#39;Se ha añadido correctamente el funko &#39;</span><span class="hl-1"> + </span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">message</span><span class="hl-1">.</span><span class="hl-3">name</span><span class="hl-1"> + </span><span class="hl-4">&#39; al usuario &#39;</span><span class="hl-1"> + </span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">user</span><br/><span class="hl-1">                }</span><br/><span class="hl-1">                </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">responseString</span><span class="hl-1"> = </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-6">stringify</span><span class="hl-1">(</span><span class="hl-3">response</span><span class="hl-1">);</span><br/><span class="hl-1">                </span><span class="hl-3">socket</span><span class="hl-1">.</span><span class="hl-6">write</span><span class="hl-1">(</span><span class="hl-3">responseString</span><span class="hl-1">);</span><br/><span class="hl-1">              }</span><br/><span class="hl-1">              </span><span class="hl-0">break</span><span class="hl-1">;</span><br/><span class="hl-1">            </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-4">&#39;remove&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">              </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">checkUserDirSync</span><span class="hl-1">(</span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">user</span><span class="hl-1">, </span><span class="hl-4">&#39;./database&#39;</span><span class="hl-1">)) {</span><br/><span class="hl-1">                </span><span class="hl-6">removeFunko</span><span class="hl-1">(</span><span class="hl-4">&#39;./database&#39;</span><span class="hl-1">, </span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">user</span><span class="hl-1">, </span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">message</span><span class="hl-1">.</span><span class="hl-3">_id</span><span class="hl-1">);</span><br/><span class="hl-1">                </span><span class="hl-3">response</span><span class="hl-1"> = {</span><br/><span class="hl-1">                  </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;remove&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">                  </span><span class="hl-3">success:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">                  </span><span class="hl-3">message:</span><span class="hl-1"> </span><span class="hl-4">&#39;Se ha borrado correctamente el funko&#39;</span><span class="hl-1"> + </span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">message</span><span class="hl-1">.</span><span class="hl-3">_id</span><span class="hl-1"> + </span><span class="hl-4">&#39; del usuario &#39;</span><span class="hl-1"> + </span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">user</span><br/><span class="hl-1">                }</span><br/><span class="hl-1">                </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">responseString</span><span class="hl-1"> = </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-6">stringify</span><span class="hl-1">(</span><span class="hl-3">response</span><span class="hl-1">);</span><br/><span class="hl-1">                </span><span class="hl-3">socket</span><span class="hl-1">.</span><span class="hl-6">write</span><span class="hl-1">(</span><span class="hl-3">responseString</span><span class="hl-1">);</span><br/><span class="hl-1">              } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">                </span><span class="hl-3">response</span><span class="hl-1"> = {</span><br/><span class="hl-1">                  </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;remove&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">                  </span><span class="hl-3">success:</span><span class="hl-1"> </span><span class="hl-2">false</span><span class="hl-1">,</span><br/><span class="hl-1">                  </span><span class="hl-3">message:</span><span class="hl-1"> </span><span class="hl-4">&#39;El usuario no existe&#39;</span><br/><span class="hl-1">                }</span><br/><span class="hl-1">                </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">responseString</span><span class="hl-1"> = </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-6">stringify</span><span class="hl-1">(</span><span class="hl-3">response</span><span class="hl-1">);</span><br/><span class="hl-1">                </span><span class="hl-3">socket</span><span class="hl-1">.</span><span class="hl-6">write</span><span class="hl-1">(</span><span class="hl-3">responseString</span><span class="hl-1">);</span><br/><span class="hl-1">              }</span><br/><span class="hl-1">              </span><span class="hl-0">break</span><span class="hl-1">;</span><br/><span class="hl-1">            </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-4">&#39;update&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">              </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">checkUserDirSync</span><span class="hl-1">(</span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">user</span><span class="hl-1">, </span><span class="hl-4">&#39;./database&#39;</span><span class="hl-1">)) {</span><br/><span class="hl-1">                </span><span class="hl-6">removeFunko</span><span class="hl-1">(</span><span class="hl-4">&#39;./database&#39;</span><span class="hl-1">, </span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">user</span><span class="hl-1">, </span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">message</span><span class="hl-1">.</span><span class="hl-3">_id</span><span class="hl-1">);</span><br/><span class="hl-1">                </span><span class="hl-6">createJsonFunkoFile</span><span class="hl-1">(</span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">user</span><span class="hl-1">, </span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">message</span><span class="hl-1">);</span><br/><span class="hl-1">                </span><span class="hl-3">response</span><span class="hl-1"> = {</span><br/><span class="hl-1">                  </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;update&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">                  </span><span class="hl-3">success:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">                  </span><span class="hl-3">message:</span><span class="hl-1"> </span><span class="hl-4">&#39;Se actualizado correctamente el funko&#39;</span><span class="hl-1"> + </span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">message</span><span class="hl-1">.</span><span class="hl-3">_id</span><span class="hl-1"> + </span><span class="hl-4">&#39; del usuario &#39;</span><span class="hl-1"> + </span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">user</span><br/><span class="hl-1">                }</span><br/><span class="hl-1">                </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">responseString</span><span class="hl-1"> = </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-6">stringify</span><span class="hl-1">(</span><span class="hl-3">response</span><span class="hl-1">);</span><br/><span class="hl-1">                </span><span class="hl-3">socket</span><span class="hl-1">.</span><span class="hl-6">write</span><span class="hl-1">((</span><span class="hl-3">responseString</span><span class="hl-1">));</span><br/><span class="hl-1">              } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">                </span><span class="hl-3">response</span><span class="hl-1"> = {</span><br/><span class="hl-1">                  </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;update&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">                  </span><span class="hl-3">success:</span><span class="hl-1"> </span><span class="hl-2">false</span><span class="hl-1">,</span><br/><span class="hl-1">                  </span><span class="hl-3">message:</span><span class="hl-1"> </span><span class="hl-4">&#39;El usuario no existe&#39;</span><br/><span class="hl-1">                }</span><br/><span class="hl-1">                </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">responseString</span><span class="hl-1"> = </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-6">stringify</span><span class="hl-1">(</span><span class="hl-3">response</span><span class="hl-1">);</span><br/><span class="hl-1">                </span><span class="hl-3">socket</span><span class="hl-1">.</span><span class="hl-6">write</span><span class="hl-1">(</span><span class="hl-3">responseString</span><span class="hl-1">);</span><br/><span class="hl-1">              }</span><br/><span class="hl-1">              </span><span class="hl-0">break</span><span class="hl-1">;</span><br/><span class="hl-1">            </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-4">&#39;list&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">              </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">checkUserDirSync</span><span class="hl-1">(</span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">user</span><span class="hl-1">, </span><span class="hl-4">&#39;./database&#39;</span><span class="hl-1">)) {</span><br/><span class="hl-1">                </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">funkos</span><span class="hl-1"> = </span><span class="hl-6">listFunko</span><span class="hl-1">(</span><span class="hl-4">&#39;./database&#39;</span><span class="hl-1">, </span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">user</span><span class="hl-1">);</span><br/><span class="hl-1">                </span><span class="hl-3">response</span><span class="hl-1"> = {</span><br/><span class="hl-1">                  </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;list&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">                  </span><span class="hl-3">success:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">                  </span><span class="hl-3">message:</span><span class="hl-1"> </span><span class="hl-4">&#39;Se ha decicido listar los funko&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">                  </span><span class="hl-3">funkoPops:</span><span class="hl-1"> </span><span class="hl-3">funkos</span><br/><span class="hl-1">                }</span><br/><span class="hl-1">                </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">responseString</span><span class="hl-1"> = </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-6">stringify</span><span class="hl-1">(</span><span class="hl-3">response</span><span class="hl-1">);</span><br/><span class="hl-1">                </span><span class="hl-3">socket</span><span class="hl-1">.</span><span class="hl-6">write</span><span class="hl-1">(</span><span class="hl-3">responseString</span><span class="hl-1">);</span><br/><span class="hl-1">              } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">                </span><span class="hl-3">response</span><span class="hl-1"> = {</span><br/><span class="hl-1">                  </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;list&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">                  </span><span class="hl-3">success:</span><span class="hl-1"> </span><span class="hl-2">false</span><span class="hl-1">,</span><br/><span class="hl-1">                  </span><span class="hl-3">message:</span><span class="hl-1"> </span><span class="hl-4">&#39;El usuario no existe&#39;</span><br/><span class="hl-1">                }</span><br/><span class="hl-1">                </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">responseString</span><span class="hl-1"> = </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-6">stringify</span><span class="hl-1">(</span><span class="hl-3">response</span><span class="hl-1">);</span><br/><span class="hl-1">                </span><span class="hl-3">socket</span><span class="hl-1">.</span><span class="hl-6">write</span><span class="hl-1">((</span><span class="hl-3">responseString</span><span class="hl-1">));</span><br/><span class="hl-1">              }</span><br/><span class="hl-1">              </span><span class="hl-0">break</span><span class="hl-1">;</span><br/><span class="hl-1">            </span><span class="hl-0">case</span><span class="hl-1"> </span><span class="hl-4">&#39;read&#39;</span><span class="hl-1">:</span><br/><span class="hl-1">              </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">checkUserDirSync</span><span class="hl-1">(</span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">user</span><span class="hl-1">, </span><span class="hl-4">&#39;./database&#39;</span><span class="hl-1">)) {</span><br/><span class="hl-1">                </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-3">ids</span><span class="hl-1">.</span><span class="hl-6">includes</span><span class="hl-1">(</span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">message</span><span class="hl-1">.</span><span class="hl-3">_id</span><span class="hl-1">)) {</span><br/><span class="hl-1">                  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">funko</span><span class="hl-1"> = </span><span class="hl-6">findFunkoByID</span><span class="hl-1">(</span><span class="hl-4">&#39;./database&#39;</span><span class="hl-1">, </span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">user</span><span class="hl-1">, </span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">message</span><span class="hl-1">.</span><span class="hl-3">_id</span><span class="hl-1">);</span><br/><span class="hl-1">                  </span><span class="hl-3">response</span><span class="hl-1"> = {</span><br/><span class="hl-1">                    </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;read&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">                    </span><span class="hl-3">success:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">                    </span><span class="hl-3">message:</span><span class="hl-1"> </span><span class="hl-4">&#39;Se ha decicido leer un funko&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">                    </span><span class="hl-3">funko:</span><span class="hl-1"> </span><span class="hl-3">funko</span><br/><span class="hl-1">                  }</span><br/><span class="hl-1">                  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">responseString</span><span class="hl-1"> = </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-6">stringify</span><span class="hl-1">(</span><span class="hl-3">response</span><span class="hl-1">);</span><br/><span class="hl-1">                  </span><span class="hl-3">socket</span><span class="hl-1">.</span><span class="hl-6">write</span><span class="hl-1">((</span><span class="hl-3">responseString</span><span class="hl-1">));</span><br/><span class="hl-1">                } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">                  </span><span class="hl-3">response</span><span class="hl-1"> = {</span><br/><span class="hl-1">                    </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;read&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">                    </span><span class="hl-3">success:</span><span class="hl-1"> </span><span class="hl-2">false</span><span class="hl-1">,</span><br/><span class="hl-1">                    </span><span class="hl-3">message:</span><span class="hl-1"> </span><span class="hl-4">&#39;El funko con id &#39;</span><span class="hl-1"> + </span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">message</span><span class="hl-1">.</span><span class="hl-3">_id</span><span class="hl-1"> + </span><span class="hl-4">&#39; ya existe en la BBDD del usuario &#39;</span><span class="hl-1"> + </span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">user</span><span class="hl-1"> </span><br/><span class="hl-1">                  }</span><br/><span class="hl-1">                  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">responseString</span><span class="hl-1"> = </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-6">stringify</span><span class="hl-1">(</span><span class="hl-3">response</span><span class="hl-1">);</span><br/><span class="hl-1">                  </span><span class="hl-3">socket</span><span class="hl-1">.</span><span class="hl-6">write</span><span class="hl-1">((</span><span class="hl-3">responseString</span><span class="hl-1">));</span><br/><span class="hl-1">                }</span><br/><span class="hl-1">              } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">                </span><span class="hl-3">response</span><span class="hl-1"> = {</span><br/><span class="hl-1">                  </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;read&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">                  </span><span class="hl-3">success:</span><span class="hl-1"> </span><span class="hl-2">false</span><span class="hl-1">,</span><br/><span class="hl-1">                  </span><span class="hl-3">message:</span><span class="hl-1"> </span><span class="hl-4">&#39;El usuario no existe&#39;</span><br/><span class="hl-1">                }</span><br/><span class="hl-1">                </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">responseString</span><span class="hl-1"> = </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-6">stringify</span><span class="hl-1">(</span><span class="hl-3">response</span><span class="hl-1">);</span><br/><span class="hl-1">                </span><span class="hl-3">socket</span><span class="hl-1">.</span><span class="hl-6">write</span><span class="hl-1">((</span><span class="hl-3">responseString</span><span class="hl-1">));</span><br/><span class="hl-1">              }  </span><br/><span class="hl-1">              </span><span class="hl-0">break</span><span class="hl-1">;</span><br/><span class="hl-1">          }</span><br/><span class="hl-1">        } </span><span class="hl-0">else</span><span class="hl-1"> </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-3">exists</span><span class="hl-1"> &amp;&amp; </span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">type</span><span class="hl-1"> == </span><span class="hl-4">&#39;add&#39;</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-6">createDirectory</span><span class="hl-1">(</span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">user</span><span class="hl-1">);</span><br/><span class="hl-1">          </span><span class="hl-6">createJsonFunkoFile</span><span class="hl-1">(</span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">user</span><span class="hl-1">, </span><span class="hl-3">request</span><span class="hl-1">.</span><span class="hl-3">message</span><span class="hl-1">);</span><br/><span class="hl-1">          </span><span class="hl-3">response</span><span class="hl-1"> = {</span><br/><span class="hl-1">            </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;add&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-3">success:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-3">message:</span><span class="hl-1"> </span><span class="hl-4">&#39;El funko ha sido creado correctamente. Además el usuario no existia en nuestra BBDD por lo que se le a añadido a la misma&#39;</span><br/><span class="hl-1">          }</span><br/><span class="hl-1">          </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">responseString</span><span class="hl-1"> = </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-6">stringify</span><span class="hl-1">(</span><span class="hl-3">response</span><span class="hl-1">);</span><br/><span class="hl-1">          </span><span class="hl-3">socket</span><span class="hl-1">.</span><span class="hl-6">write</span><span class="hl-1">((</span><span class="hl-3">responseString</span><span class="hl-1">));</span><br/><span class="hl-1">        } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-3">response</span><span class="hl-1"> = {</span><br/><span class="hl-1">            </span><span class="hl-3">type:</span><span class="hl-1"> </span><span class="hl-4">&#39;error&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-3">success:</span><span class="hl-1"> </span><span class="hl-2">false</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-3">message:</span><span class="hl-1"> </span><span class="hl-4">&#39;El usuario no existe&#39;</span><br/><span class="hl-1">          }</span><br/><span class="hl-1">          </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-7">responseString</span><span class="hl-1"> = </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-6">stringify</span><span class="hl-1">(</span><span class="hl-3">response</span><span class="hl-1">);</span><br/><span class="hl-1">          </span><span class="hl-3">socket</span><span class="hl-1">.</span><span class="hl-6">write</span><span class="hl-1">((</span><span class="hl-3">responseString</span><span class="hl-1">));</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-3">socket</span><span class="hl-1">.</span><span class="hl-6">on</span><span class="hl-1">(</span><span class="hl-4">&#39;end&#39;</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">chalk</span><span class="hl-1">.</span><span class="hl-3">bold</span><span class="hl-1">.</span><span class="hl-6">cyan</span><span class="hl-1">(</span><span class="hl-4">&#39;Cliente desconectado&#39;</span><span class="hl-1">));</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-3">server</span><span class="hl-1">.</span><span class="hl-6">listen</span><span class="hl-1">(</span><span class="hl-5">8002</span><span class="hl-1">, () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-3">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">chalk</span><span class="hl-1">.</span><span class="hl-3">bold</span><span class="hl-1">.</span><span class="hl-6">cyan</span><span class="hl-1">(</span><span class="hl-4">&#39;Servidor a la escucha en el puerto 8002&#39;</span><span class="hl-1">));</span><br/><span class="hl-1">});</span>
</code></pre>
<p>Antes de empezar, comentar que la mayor parte de los procesos realizados en el servidor se han realizado mediante APIs síncronas de NODE.js incumpliendo con uno de los requsitos de las prácticas, sin embargo, esto esta explicado en el apartado <em><a href="#dificultadesreflexi%C3%B3n">Dificultades/Reflexión</a></em>.</p>
<p>La comprobación de si existe un directorio con el nombre del usuario se realiza mediante código asíncrono, haciendo uso de un ejemplo similar al explicado en el ejercicio 1 de esta práctica. Asimismo, se realiza de manera asíncrona la creación de un directorio para un usuario en caso de que este no exista y el mensaje del request sea de tipo <em>add</em>. El resto de funciones son síncronas.</p>
<p>Una vez explicado esto, mencionar por encima los aspectos de mayor relevancia del servidor. Primero se procesa la request enviada por el cliente, se examina el tipo de esta y en funcion de este se va realizando el comando en cuestión, con métodos levementes modificados de los usados en la práctica 9 de la asignatura. Tras procesar el comando, se prepara un mensaje de tipo response el cual el servidor le enviará al cliente para que este lo procese e imprima por consola.</p>

<a href="#dificultadesreflexión" id="dificultadesreflexión" style="color: inherit; text-decoration: none;">
  <h2><strong>Dificultades/Reflexión</strong></h2>
</a>
<p>La mayor dificultad de esta práctica ha sido la implementación de la API asíncrona de NODE.JS para el ejercicio 3. Tras intentar implementarla como el código síncrono se ejecuta detrás de esta no se estaba obteniendo el resultado deseado en la parte del servidor. Solamente llevé a cabo dos métodos asíncronos, los encargados de comprobar que existe un fichero para un usuario pasado al servidor y la creación de un directorio para ese usuario si no existe y se mando un request de tipo <em>add</em>.</p>
<p>El resto de código es similar al de la práctica anterior, síncrono pero con leves modificaciones.</p>
<p>¿A que se debe esto?.</p>
<p>Desde mi punto de vista, me hubiese gustado dejar la práctica lo mejor posible y cumpliendo con todos los requisitos que se pedían. Sin embargo, nos encontramos en un mes bastante complicado en la carrera en el cual contamos con una gran carga de trabajo por parte de las cinco asignaturas, si le sumamos las 4h de jornada laboral que cumplo durante 5 días de la semanas y que el próximo lunes 17 de abril tenemos un examen al cual le he dedicado todo el tiempo posible, pues se me ha hecho muy dificil llevar a cabo la práctica tal y como me gustaría.</p>
<p>Me enorgullece haber sacado tiempo en los descansos y en el transporte entre la universidad y mi casa para adelantar todo lo posible esta práctica. </p>
<p>Asimismo, comprendo que se nos ha dejado más tiempo para realizarla y que es algo irónico el hecho de que no haya podido completarla, pero como mencioné anteriormente le dedique todo el tiempo posible al examen.</p>

<a href="#referencias" id="referencias" style="color: inherit; text-decoration: none;">
  <h2><strong>Referencias</strong></h2>
</a>
<p><a href="https://ull-esit-inf-dsi-2223.github.io/prct10-fs-proc-sockets-funko-app/">Guión pr10</a>
<a href="https://ull-esit-inf-dsi-2223.github.io/nodejs-theory/">Apuntes bloque 2 de la asignatura</a>
<a href="https://ull-esit-inf-dsi-2223.github.io/prct09-filesystem-funko-app/">GFuion de la práctica</a>
<a href="https://coveralls.io/">Coveralls</a>
<a href="https://sonarcloud.io/explore/projects">SonarCloud</a>
<a href="https://nodejs.org/docs/latest-v19.x/api/fs.html">Documentación NODE.js</a>
<a href="https://www.npmjs.com/package/yargs">Doc yargs</a>
<a href="https://www.npmjs.com/package/chalk">Doc chalk</a></p>
</div></div>
<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
<div class="tsd-navigation settings">
<details class="tsd-index-accordion"><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg> Settings</h3></summary>
<div class="tsd-accordion-details">
<div class="tsd-filter-visibility">
<h4 class="uppercase">Member Visibility</h4><form>
<ul id="tsd-filter-options">
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div>
<div class="tsd-theme-toggle">
<h4 class="uppercase">Theme</h4><select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div>
<nav class="tsd-navigation primary">
<details class="tsd-index-accordion" open><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg> Modules</h3></summary>
<div class="tsd-accordion-details">
<ul>
<li class="current selected"><a href="modules.html">pr10</a>
<ul>
<li class="tsd-kind-module"><a href="modules/Ejercicio2_readFileContent_withOutPipeStream_functionality.html">Ejercicio2-<wbr/>read<wbr/>File<wbr/>Content/with<wbr/>Out<wbr/>Pipe<wbr/>Stream/functionality</a></li>
<li class="tsd-kind-module"><a href="modules/Ejercicio2_readFileContent_withOutPipeStream_utilities.html">Ejercicio2-<wbr/>read<wbr/>File<wbr/>Content/with<wbr/>Out<wbr/>Pipe<wbr/>Stream/utilities</a></li>
<li class="tsd-kind-module"><a href="modules/Ejercicio2_readFileContent_withPipeStream_functionality.html">Ejercicio2-<wbr/>read<wbr/>File<wbr/>Content/with<wbr/>Pipe<wbr/>Stream/functionality</a></li>
<li class="tsd-kind-module"><a href="modules/Ejercicio2_readFileContent_withPipeStream_utilities.html">Ejercicio2-<wbr/>read<wbr/>File<wbr/>Content/with<wbr/>Pipe<wbr/>Stream/utilities</a></li>
<li class="tsd-kind-module"><a href="modules/Ejercicio3_Funko_app_async_funkoInterface.html">Ejercicio3-<wbr/>Funko-<wbr/>app-<wbr/>async/funko<wbr/>Interface</a></li>
<li class="tsd-kind-module"><a href="modules/Ejercicio3_Funko_app_async_types.html">Ejercicio3-<wbr/>Funko-<wbr/>app-<wbr/>async/types</a></li>
<li class="tsd-kind-module"><a href="modules/Ejercicio3_Funko_app_async_utilities.html">Ejercicio3-<wbr/>Funko-<wbr/>app-<wbr/>async/utilities</a></li>
<li class="tsd-kind-module"><a href="modules/Ejercicio3_Funko_app_async_utilities2.html">Ejercicio3-<wbr/>Funko-<wbr/>app-<wbr/>async/utilities2</a></li>
<li class="tsd-kind-module"><a href="modules/EjercicioPE102_client.html">EjercicioPE102/client</a></li>
<li class="tsd-kind-module"><a href="modules/EjercicioPE102_command.html">EjercicioPE102/command</a></li>
<li class="tsd-kind-module"><a href="modules/EjercicioPE102_server.html">EjercicioPE102/server</a></li></ul></li></ul></div></details></nav></div></div>
<div class="container tsd-generator">
<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div>
<div class="overlay"></div><script src="assets/main.js"></script></body></html>